(function(){var e={"esri/core/HandleOwner":111,"esri/views/layers/RefreshableLayerView":144,"esri/views/layers/LayerView":149,"esri/views/3d/layers/support/layerViewUpdatingProperties":173,"esri/views/3d/layers/LayerView3D":179,"esri/views/3d/terrain/terrainUtils":485,"esri/views/3d/layers/TiledLayerView3D":510,"esri/views/3d/terrain/terrainUtilsPlanar":511,"esri/views/3d/terrain/terrainUtilsSpherical":512,"esri/views/3d/layers/WMTSLayerView3D":2170},t=this||window,i=t.webpackJsonp=t.webpackJsonp||[];i.registerAbsMids?i.registerAbsMids(e):(i.absMidsWaiting=i.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{111:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(28),i(27),i(38),i(68),i(29)],void 0===(n=function(e,t,i,r,n,a,o){return function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=e.call(this)||this;return r.handles=new a,r}return i(t,e),t.prototype.destroy=function(){this.handles.destroy()},r([o.property({readOnly:!0})],t.prototype,"handles",void 0),r([o.subclass("esri.core.HandleOwner")],t)}(o.declared(n))}.apply(null,r))||(e.exports=n)},144:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(28),i(27),i(38),i(29)],void 0===(n=function(e,t,i,r,n,a){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.refreshTimestamp=null,t}return i(t,e),t.prototype.refresh=function(e){void 0===e&&(e=Date.now()),this._set("refreshTimestamp",e),this.doRefresh&&this.doRefresh()},r([a.property()],t.prototype,"layer",void 0),r([a.aliasOf("layer.refreshInterval")],t.prototype,"refreshInterval",void 0),r([a.property({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),r([a.subclass("esri.layers.mixins.RefreshableLayerView")],t)}(a.declared(n))}.apply(null,r))||(e.exports=n)},149:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(28),i(27),i(120),i(111),i(165),i(33),i(127),i(32),i(29)],void 0===(n=function(e,t,i,r,n,a,o,l,s,p,c){return function(e){function t(t){var i=e.call(this)||this;return i.layer=null,i.parent=null,i.view=null,i}return i(t,e),t.prototype.initialize=function(){var e=this;this.addResolvingPromise(this.layer),this.when().catch(function(t){if("layerview:create-error"!==t.name){var i=e.layer&&e.layer.id||"no id",r=e.layer&&e.layer.title||"no title";return l.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+r+"', id: '"+i+"')",t),p.reject(t)}})},t.prototype.destroy=function(){this.layer=this.view=this.parent=null},Object.defineProperty(t.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.suspended&&this.isUpdating()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullOpacity",{get:function(){var e=function(e){return null!=e?e:1};return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))},enumerable:!0,configurable:!0}),t.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},t.prototype.isUpdating=function(){return!1},r([c.property()],t.prototype,"layer",void 0),r([c.property()],t.prototype,"parent",void 0),r([c.property({readOnly:!0,dependsOn:["view","visible","layer.loaded","parent.suspended"]})],t.prototype,"suspended",null),r([c.property({type:Boolean,dependsOn:["suspended"],readOnly:!0})],t.prototype,"updating",null),r([c.property()],t.prototype,"view",void 0),r([c.property({dependsOn:["layer.visible"]})],t.prototype,"visible",null),r([c.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],t.prototype,"fullOpacity",null),r([c.subclass("esri.views.layers.LayerView")],t)}(c.declared(a,n,o.Identifiable,s))}.apply(null,r))||(e.exports=n)},173:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.updatingPercentageValue={value:100,readOnly:!0},t.updatingPercentage={dependsOn:["updating","updatingPercentageValue"],readOnly:!0,value:0,get:function(){return this.updating?this.updatingPercentageValue:0}}}.apply(null,r))||(e.exports=n)},179:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(28),i(27),i(32),i(66),i(29),i(554),i(149)],void 0===(n=function(e,t,i,r,n,a,o,l,s){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.slicePlaneEnabled=!1,t.supportsHeightUnitConversion=!1,t}return i(t,e),t.prototype.postscript=function(e){this.inherited(arguments),l.mayHaveHeightModelInfo(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())},t.prototype._validateHeightModelInfo=function(){var e=this;return n.create(function(t,i){a.whenFalseOnce(e.view.defaultsFromMap,"isHeightModelInfoSearching",function(){var r=l.rejectLayerError(e.layer,e.view.heightModelInfo,e.supportsHeightUnitConversion);r?i(r):t()})})},r([o.property()],t.prototype,"view",void 0),r([o.property()],t.prototype,"slicePlaneEnabled",void 0),r([o.subclass("esri.views.3d.layers.LayerView3D")],t)}(o.declared(s))}.apply(null,r))||(e.exports=n)},2170:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(28),i(27),i(35),i(68),i(33),i(32),i(66),i(29),i(510),i(144)],void 0===(n=function(e,t,i,r,n,a,o,l,s,p,c,u){var d=o.getLogger("esri.views.3d.layers.WMTSLayerView3d");return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handles=new a,t}return i(t,e),t.prototype.initialize=function(){var e=this,t=s.whenTrueOnce(this.view,"basemapTerrain.tilingSchemeDone").then(function(){var t=function(){return new n("layerview:no-compatible-tiling-scheme","None of the tiling schemes supported by the service are compatible with the scene.")};if(!e.view.basemapTerrain.tilingSchemeLocked)return l.reject(t());var i,r=e.view.basemapTerrain.tilingScheme,a=e.layer.activeLayer;if(a&&a.tileMatrixSet){var o=(i=a.tileMatrixSet).tileInfo,s=e._getTileInfoSupportError(o,i.fullExtent)||e._getTileInfoCompatibilityError(o,r);if(s)return l.reject(s)}else{if(!(i=e._getCompatibleTileMatrixSet()))return l.reject(t());a.tileMatrixSetId=i.id}e.tileInfo=i.tileInfo,e.fullExtent=i.fullExtent,e._updateMinMaxDataLevel()});this.addResolvingPromise(t),this.when(function(){return e._initialized()})},t.prototype.destroy=function(){this._handles.removeAll()},t.prototype.refresh=function(){this.emit("data-changed")},t.prototype.canResume=function(){if(!this.inherited(arguments))return!1;var e=this.layer.activeLayer.tileMatrixSet;return e&&!this._getTileInfoError(e.tileInfo,e.fullExtent)},t.prototype.doRefresh=function(){this.suspended||this.emit("data-changed")},t.prototype._initialized=function(){var e=this;this._handles.add(this.watch("layer.activeLayer.styleId, tileMatrixSet",function(){return e.refresh()})),this._handles.add(this.layer.watch("activeLayer",function(t){var i=t.tileMatrixSet;if(i){var r=e._getTileInfoError(i.tileInfo,i.fullExtent);r&&(d.error("The selected tile matrix set is not compatible with the view",r),i=null)}else(i=e._getCompatibleTileMatrixSet())?t.tileMatrixSetId=i.id:d.error("The layer does not provide a tiling scheme that is compatible with the view");e.notifyChange("suspended"),e.canResume()&&e.refresh()}))},t.prototype._getCompatibleTileMatrixSet=function(){var e=this;return this.layer.activeLayer.tileMatrixSets.find(function(t){var i=t.tileInfo;return!e._getTileInfoError(i,t.fullExtent)})},t.prototype._getTileInfoError=function(e,t){return this._getTileInfoSupportError(e,t)||this._getTileInfoCompatibilityError(e,this.view.basemapTerrain.tilingScheme)},r([p.property({aliasOf:"layer.fullExtent"})],t.prototype,"fullExtent",void 0),r([p.property()],t.prototype,"layer",void 0),r([p.property({dependsOn:["layer.activeLayer"]})],t.prototype,"suspended",void 0),r([p.property({aliasOf:"layer.tileInfo"})],t.prototype,"tileInfo",void 0),r([p.subclass("esri.views.3d.layers.WMTSLayerView3D")],t)}(p.declared(c,u))}.apply(null,r))||(e.exports=n)},485:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(287),i(299),i(319),i(548),i(511),i(512)],void 0===(n=function(e,t,i,r,n,a,o,l){function s(e){return e&&"esri.views.3d.layers.TileLayerView3D"===e.declaredClass}function p(e){return e&&"esri.views.3d.layers.VectorTileLayerView3D"===e.declaredClass}function c(e){return e&&"esri.views.3d.layers.WMTSLayerView3D"===e.declaredClass}function u(e){return e&&"esri.views.3d.layers.ElevationLayerView3D"===e.declaredClass}function d(){for(var e in h={},a)a[e].baseMapLayers.forEach(function(e){h[e.url]=19});h["//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"]=20}function f(e,t,i,r){return y["local"===r||"planar"===r?"planar":"spherical"].checkIfTileInfoSupportedForViewSR(e,t,i)}Object.defineProperty(t,"__esModule",{value:!0});var y={planar:o,spherical:l};t.weakAssert=function(e,t){e||console.warn("Terrain: "+t)},t.autoUpdateSkirtsVisibility=function(e,t,i){var r,n=y[e.manifold],a=n.isInsideExtent(e,t);if(a)r=e.getElevation(t);else{var o=e.getElevationBounds();r=.5*(o[0]+o[1])}var l=t[2]-r,s=.9*Math.abs(l)<i?0:l<0?-1:1;if(!a)if(n.isInsideExtent(e,t,e.hideSkirtsDistanceFromExtentMargin)){var p=n.tiltToExtentEdge(e,t);p>e.hideSkirtsMinimumCameraTilt&&p<e.hideSkirtsMaximumCameraTilt&&(s=0)}else s=0;e.skirtScale=s},t.isTiledLayer=function(e){return e&&"base-tile"===e.type||"tile"===e.type||"elevation"===e.type||"base-elevation"===e.type||"open-street-map"===e.type||"web-tile"===e.type||"wmts"===e.type||"vector-tile"===e.type},t.isVectorTileLayer=function(e){return e&&e.isInstanceOf(n)},t.isTileLayerView=s,t.isVectorTileLayerView=p,t.isWMTSLayerView=c,t.isElevationLayerView=u,t.isTiledLayerView=function(e){return e&&(s(e)||u(e)||p(e)||c(e))},t.useFetchTileForLayer=function(e){return e.fetchTile&&!(e.fetchTile===r.prototype.fetchTile||e.fetchTile===i.prototype.fetchTile)};var h=null;t.getKnownTiledServiceLevelCap=function(e){h||d();var t=e&&e.replace(/https?:/,"");return t in h?h[t]:1/0},t.prepareKnownTiledServiceLevelCaps=d,t.checkIfTileInfoSupportedForView=f,t.getTiledLayerInfo=function(e,t,i){var r,n;if("wmts"===e.type){var a=e.activeLayer;if(a){var o=a.tileMatrixSet;if(o)r=o.tileInfo,n=o.fullExtent;else{var l=a.tileMatrixSets;if(l){var s=l.find(function(e){return null==f(e.tileInfo,e.fullExtent,t,i)});if(s)return{tileInfo:s.tileInfo,fullExtent:s.fullExtent}}}}}else r="vector-tile"===e.type?e.compatibleTileInfo256:e.tileInfo,n=e.fullExtent;return r&&n&&null==f(r,n,t,i)?{tileInfo:r,fullExtent:n}:{tileInfo:null,fullExtent:null}}}.apply(null,r))||(e.exports=n)},510:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(28),i(27),i(35),i(29),i(179),i(173),i(485)],void 0===(n=function(e,t,i,r,n,a,o,l,s){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.minDataLevel=0,t.maxDataLevel=1/0,t._isUpdating=!1,t}return i(t,e),Object.defineProperty(t.prototype,"imageFormatIsOpaque",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isOpaque",{get:function(){return this.fullOpacity>=1&&this.imageFormatIsOpaque},enumerable:!0,configurable:!0}),t.prototype.getTileUrl=function(e,t,i){return this.layer.getTileUrl(e,t,i)},t.prototype.updatingChanged=function(e){this._isUpdating=e,this.notifyChange("updating")},t.prototype.isUpdating=function(){return this._isUpdating},t.prototype._getTileInfoSupportError=function(e,t){var i=s.checkIfTileInfoSupportedForView(e,t,this.view.spatialReference,this.view.basemapTerrain.manifold);if(i){var r={layer:this.layer,error:i},a=void 0;switch(i.name){case"tilingscheme:local-gcs-not-supported":a=new n("layerview:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes",r);break;case"tilingscheme:spatial-reference-mismatch":case"tilingscheme:global-unsupported-spatial-reference":a=new n("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",r);break;default:a=new n("layerview:tiling-scheme-unsupported","The tiling scheme of this layer is not supported by SceneView",r)}return a}return null},t.prototype._getTileInfoCompatibilityError=function(e,t){return t.compatibleWith(e)?null:new n("layerview:tiling-scheme-incompatible","The tiling scheme of this layer is incompatible with the tiling scheme of the surface")},t.prototype._updateMinMaxDataLevel=function(){var e,t=1/0,i=0;this.tileInfo.lods.forEach(function(e){t=Math.min(e.level,t),i=Math.max(e.level,i)}),e=[t,i],this.minDataLevel=e[0],this.maxDataLevel=e[1]},r([a.property({readOnly:!0})],t.prototype,"imageFormatIsOpaque",null),r([a.property(l.updatingPercentage)],t.prototype,"updatingPercentage",void 0),r([a.property(l.updatingPercentageValue)],t.prototype,"updatingPercentageValue",void 0),r([a.property()],t.prototype,"fullExtent",void 0),r([a.property({readOnly:!0,dependsOn:["fullOpacity","imageFormatIsOpaque"]})],t.prototype,"isOpaque",null),r([a.property()],t.prototype,"layer",void 0),r([a.property()],t.prototype,"minDataLevel",void 0),r([a.property()],t.prototype,"maxDataLevel",void 0),r([a.property()],t.prototype,"tileInfo",void 0),r([a.subclass("esri.views.3d.layers.TiledLayerView3D")],t)}(a.declared(o))}.apply(null,r))||(e.exports=n)},511:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(35),i(26),i(54),i(589),i(415)],void 0===(n=function(e,t,i,r,n,a,o){function l(e,t,i,n){r.vec3.copy(p,i),p[n]=t[n];var a,o=r.vec3.subtract(p,p,t),l=r.vec3.subtract(c,e,t),s=r.vec3.dot(l,o),u=r.vec3.dot(o,o);a=s<=0?t:u<=s?i:r.vec3.add(p,t,r.vec3.scale(o,o,s/u));var d=r.vec3.subtract(p,e,a);return Math.PI/2-Math.atan(d[2]/Math.sqrt(d[0]*d[0]+d[1]*d[1]))}function s(e,t){var r=e.lods,l=r[0].resolution*Math.pow(2,r[0].level),s=[l*e.size[0],l*e.size[1]],p=[e.origin.x,e.origin.y],c=n.fromExtent(t),u=n.create();o.computeRowColExtent(c,s,p,u);var d=(u[2]-u[0])*(u[3]-u[1]);if(d>a.MAX_ROOT_TILES){var f=r[0].scale*Math.pow(2,r[0].level),y=Math.max((c[3]-c[1])/e.size[1],(c[2]-c[0])/e.size[0])*f/l,h=Math.floor(Math.log(y)/Math.log(10));return y=Math.ceil(y/Math.pow(10,h))*Math.pow(10,h),new i("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(f).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+y.toLocaleString()+".",{level0Scale:f,suggestedLevel0Scale:y,requiredNumRootTiles:d,allowedNumRootTiles:a.MAX_ROOT_TILES})}return null}Object.defineProperty(t,"__esModule",{value:!0});var p=r.vec3f64.create(),c=r.vec3f64.create(),u=r.vec3f64.create(),d=r.vec3f64.create();t.isInsideExtent=function(e,t,i){void 0===i&&(i=0);var r=e.extent;if(0===i)return n.containsPoint(r,t);var a=Math.min(r[2]-r[0],r[3]-r[1]);return n.containsPointWithMargin(r,t,i*a)},t.tiltOnEdge=l,t.tiltToExtentEdge=function(e,t){var i=e.getElevationBounds(),r=e.extent,n=.5*(i[0]+i[1]);u[0]=r[0],u[1]=r[1],u[2]=n,d[0]=r[2],d[1]=r[3],d[2]=n;var a=1/0,o=1/0;return t[0]<u[0]?a=l(t,u,d,0):t[0]>d[0]&&(a=l(t,d,u,0)),t[1]<u[1]?o=l(t,u,d,1):t[1]>d[1]&&(o=l(t,d,u,1)),Math.min(a,o)},t.checkIfTileInfoSupportedForViewSR=function(e,t,r){if(e.spatialReference.isGeographic)return new i("tilingscheme:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes");var n=o.checkUnsupported(e);return n||s(e,t)||(r&&!e.spatialReference.equals(r)?new i("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene"):null)}}.apply(null,r))||(e.exports=n)},512:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(35),i(415)],void 0===(n=function(e,t,i,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isInsideExtent=function(e,t,i){return void 0===i&&(i=0),!0},t.tiltToExtentEdge=function(e,t){return 0},t.checkIfTileInfoSupportedForViewSR=function(e,t,n){var a=e.lods.length-1;if(e.spatialReference.isWebMercator){if(!r.makeWebMercatorAuxiliarySphere(a).compatibleWith(e))return new i("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else{if(!e.spatialReference.isWGS84)return new i("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(!r.makeWGS84WithTileSize(e.size[1],a).compatibleWith(e))return new i("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme")}if(n&&!e.spatialReference.equals(n))return new i("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene")}}.apply(null,r))||(e.exports=n)}}]);