(function(){var e={"esri/views/layers/ImageryLayerView":843,"esri/views/2d/layers/ImageryLayerView2D":2129},t=this||window,r=t.webpackJsonp=t.webpackJsonp||[];r.registerAbsMids?r.registerAbsMids(e):(r.absMidsWaiting=r.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{2129:function(e,t,r){var a,i;a=[r.dj.c(e.i),t,r(28),r(27),r(98),r(68),r(32),r(66),r(29),r(403),r(210),r(842),r(843)],void 0===(i=function(e,t,r,a,i,n,o,s,p,u,l,c,d){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handles=new n,t.container=new u.BitmapContainer,t}return r(t,e),t.prototype.hitTest=function(e,t){if(this.suspended)return o.resolve(null);var r=this.view.toMap(e,t);return o.resolve(new i({attributes:{},geometry:r}))},t.prototype.update=function(e){this.strategy.update(e),this.notifyChange("updating")},t.prototype.attach=function(){var e=this;this.strategy=new c({container:this.container,fetchSource:this.fetchImage.bind(this),requestUpdate:function(){return e.requestUpdate()}}),this._handles.add([s.watch(this,"layer.exportImageServiceParameters.version",function(t){e._exportImageVersion!==t&&(e._exportImageVersion=t,e.requestUpdate())}),this.layer.on("redraw",function(){e.strategy.updateExports(function(t){var r=t.source.getContext("2d");return e.pixelData=e.layer.applyFilter(e._rawPixelData),e._drawPixelData(r,e.pixelData,0,0),null})})])},t.prototype.detach=function(){this.strategy.destroy(),this._handles.removeAll(),this.container.removeAllChildren()},t.prototype.moveStart=function(){},t.prototype.viewChange=function(){},t.prototype.moveEnd=function(){this.requestUpdate()},t.prototype.doRefresh=function(){this.requestUpdate()},t.prototype.isUpdating=function(){return this.attached&&(this.strategy.updating||this.updateRequested)},t.prototype.fetchImage=function(e,t,r,a){var i=this;return this._exportImageVersion=this.get("layer.exportImageServiceParameters.version"),this.layer.fetchImage(e,t,r,a).then(function(e){i._rawPixelData=e.pixelData,i.pixelData=i.layer.applyFilter(i._rawPixelData);var a=document.createElement("canvas");a.width=t,a.height=r;var n=a.getContext("2d");return i._drawPixelData(n,i.pixelData,0,0),i.notifyChange("updating"),a})},t.prototype._drawPixelData=function(e,t,r,a){if(t.pixelBlock){var i=t.pixelBlock,n=e.createImageData(i.width,i.height),o=i.getAsRGBA();n.data.set(o),e.putImageData(n,r,a)}},a([p.subclass("esri.views.2d.layers.ImageryLayerView2D")],t)}(p.declared(l,d))}.apply(null,a))||(e.exports=i)},843:function(e,t,r){var a,i;a=[r.dj.c(e.i),t,r(28),r(27),r(35),r(32),r(29),r(131),r(144)],void 0===(i=function(e,t,r,a,i,n,o,s,p){return function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.fetchPopupFeatures=function(e){var t=this.layer;if(!e)return n.reject(new i("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:t}));var r=t.popupTemplate,a=t.popupEnabled;if(!a||!r)return n.reject(new i("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:a,popupTemplate:r}));var o=r.requiredFields,p=new s;p.geometry=e,p.outFields=o;var u={rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0,layerView:this};return t.queryVisibleRasters(p,u).then(function(e){return e})},a([o.property()],t.prototype,"layer",void 0),a([o.subclass("esri.views.layers.ImageryLayerView")],t)}(o.declared(p))}.apply(null,a))||(e.exports=i)}}]);